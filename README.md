# Image Retrieval: –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –ø–æ–ª–∫–µ

## –û –ø—Ä–æ–µ–∫—Ç–µ

–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∞—è —Ä–æ–∑–Ω–∏—á–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è –æ–±—Ä–∞—Ç–∏–ª–∞—Å—å —Å –∑–∞–ø—Ä–æ—Å–æ–º –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É —Å–∏—Å—Ç–µ–º—ã –Ω–∞ –±–∞–∑–µ **–∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è (CV)** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–∫–ª–∞–¥–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –ø–æ–ª–∫–∞—Ö.
–¶–µ–ª—å: –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –ø–æ–ª–∫–µ –∏ –≤–µ—Ä–Ω—É—Ç—å –µ–≥–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ. –í —Å–ª—É—á–∞–µ —É—Å–ø–µ—à–Ω–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏–µ –±—É–¥–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–æ –∏ –≤–Ω–µ–¥—Ä–µ–Ω–æ –≤ —Å–µ—Ç—å –º–∞–≥–∞–∑–∏–Ω–æ–≤.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ retrieval.py             # –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è predict_image()
‚îú‚îÄ‚îÄ run.py                   # –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –∏ –æ—Ü–µ–Ω–∫–∏
‚îú‚îÄ‚îÄ requirements.txt         # –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ public_tests/            # –ü–∞–ø–∫–∞ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–∏ (gallery + query)
‚îÇ   ‚îú‚îÄ‚îÄ 01_‚Ä¶_input/          # –ü–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ files.json
‚îÇ   ‚îî‚îÄ‚îÄ ‚Ä¶                    
‚îî‚îÄ‚îÄ README.md                # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

### 1. –°–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
python3 -m venv venv
source venv/bin/activate      # Linux / macOS
# venv\Scripts\activate.bat   # Windows (cmd)
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —Ç–µ—Å—Ç–∞—Ö

```bash
python run.py public_tests/
```

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã —É–≤–∏–¥–∏—Ç–µ –º–µ—Ç—Ä–∏–∫—É `Mark: X`, –≥–¥–µ X ‚Äî –≤–∞—à–∞ –æ—Ü–µ–Ω–∫–∞ –ø–æ –ø—É–±–ª–∏—á–Ω—ã–º —Ç–µ—Å—Ç–∞–º.

---

## –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥

* **Gallery** (`gallery`) ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª–∫–∏ (—Ü–≤–µ—Ç–Ω–æ–µ, –±–µ–∑ —Ä–∞–º–æ–∫).
* **Query** (`query`) ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞, –≤—ã—Ä–µ–∑–∞–Ω–Ω–æ–≥–æ –ø–æ –∫–æ–Ω—Ç—É—Ä—É.

### –í—ã—Ö–æ–¥

–§—É–Ω–∫—Ü–∏—è `predict_image(gallery, query)` –¥–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤:

```python
[
  (x_min, y_min, width, height),
  ...
]
```

* –í—Å–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫ \[0, 1]:

  * `x_min = x_pixels / —à–∏—Ä–∏–Ω–∞`
  * `y_min = y_pixels / –≤—ã—Å–æ—Ç–∞`
  * `width = —à–∏—Ä–∏–Ω–∞_—Ç–æ–≤–∞—Ä–∞ / —à–∏—Ä–∏–Ω–∞`
  * `height = –≤—ã—Å–æ—Ç–∞_—Ç–æ–≤–∞—Ä–∞ / –≤—ã—Å–æ—Ç–∞`

---

## –û—Ü–µ–Ω–∫–∞

* **–ù–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–∞**: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `[(0,0,1,1)]`, –µ—Å–ª–∏ —Ç–æ–≤–∞—Ä –Ω–∞–π–¥–µ–Ω, –∏–Ω–∞—á–µ `[]`.
* **–¢–æ—á–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å–ª–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –±–æ–∫—Å–æ–≤ —Å ground-truth.
* –ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ `run.py` –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫ `accuracy` –∏ `exists`.

---

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
import cv2
from retrieval import predict_image

gallery = cv2.imread("public_tests/01_test_input/image_01.jpg")
query   = cv2.imread("public_tests/01_test_input/template_01.jpg")

boxes = predict_image(gallery, query)
print("–ù–∞–π–¥–µ–Ω–Ω—ã–µ –±–æ–∫—Å—ã:", boxes)
```

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

* `numpy`
* `opencv-python`
* `scikit-image`
* `Pillow`

–î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —Å–º. `requirements.txt`.

---

## –ê–≤—Ç–æ—Ä

‚Äî –°–æ–ª—É—è–Ω–æ–≤–∞ –ó–ª–∞—Ç–∞

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö.
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–∞—Ö –±–µ–∑ —Å–æ–≥–ª–∞—Å–∏—è –∞–≤—Ç–æ—Ä–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–æ.
